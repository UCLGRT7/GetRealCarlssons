<Page x:Class="CarlssonsWPF.Views.Projekt.ViewProjectView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="clr-namespace:CarlssonsWPF.Views.Projekt"
      xmlns:helpers="clr-namespace:CarlssonsWPF.Helpers"
      mc:Ignorable="d"
      d:DesignHeight="720"
      d:DesignWidth="1280"
      Title="ViewProjectView">

    <Page.Resources>
        <Style x:Key="DateTextBoxStyle" TargetType="TextBox">
            <EventSetter Event="PreviewTextInput" Handler="DateAutoFormatter"/>
        </Style>
    </Page.Resources>

    <Grid Margin="10">
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" Margin="0,0,500,0">
            <Grid x:Name="LeftGrid" Margin="40" Height="540" Width="420">
                <Grid.RowDefinitions>
                    <RowDefinition Height="30"/>
                    <!-- Navn -->
                    <RowDefinition Height="30"/>
                    <!-- Sagsnummer -->
                    <RowDefinition Height="30"/>
                    <!-- Adresse -->
                    <RowDefinition Height="30"/>
                    <!-- Deadline -->
                    <RowDefinition Height="30"/>
                    <!-- Postnummer -->
                    <RowDefinition Height="30"/>
                    <!-- Omfang -->
                    <RowDefinition Height="30"/>
                    <!-- Ydelser header -->
                    <RowDefinition Height="15"/>
                    <RowDefinition Height="17"/>
                    <RowDefinition Height="16"/>
                    <RowDefinition Height="16"/>
                    <RowDefinition Height="30"/>
                    <!-- Økonomi header -->
                    <RowDefinition Height="30"/>
                    <!-- Tilbud Afsendt -->
                    <RowDefinition Height="30"/>
                    <!-- Tilbud Godkendt -->
                    <RowDefinition Height="30"/>
                    <!-- Anslået pris -->
                    <RowDefinition Height="30"/>
                    <!-- Pris -->
                    <RowDefinition Height="30"/>
                    <!-- Betalt -->
                    <RowDefinition Height="25"/>
                    <!-- Knapper -->
                    <RowDefinition Height="50"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="140"/>
                    <ColumnDefinition Width="280"/>
                    <ColumnDefinition Width="200"/>
                </Grid.ColumnDefinitions>

                <!-- Navn -->
                <TextBlock Text="Navn:" Grid.Row="0" Grid.Column="0" Margin="105,0,0,0" Height="16" Width="30" VerticalAlignment="Center" HorizontalAlignment="Left" />
                <ContentControl Grid.Row="0" Grid.Column="1" Content="{Binding SelectedProject}">
                    <ContentControl.Style>
                        <Style TargetType="ContentControl">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsEditing}" Value="True">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <ComboBox ItemsSource="{Binding DataContext.Customers, RelativeSource={RelativeSource AncestorType=Page}}"
                                          SelectedItem="{Binding SelectedProject.Customer, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                          DisplayMemberPath="Name"
                                          Height="22" HorizontalAlignment="Right" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsEditing}" Value="False">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding SelectedProject.CustomerName}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ContentControl.Style>
                </ContentControl>

                <!-- Sagsnummer -->
                <TextBlock Text="Sagsnummer:" Grid.Row="1" Grid.Column="0" Margin="63,0,0,0" Height="16" Width="72" VerticalAlignment="Center" HorizontalAlignment="Left" />
                <ContentControl Grid.Row="1" Grid.Column="1" Content="{Binding SelectedProject}">
                    <ContentControl.Style>
                        <Style TargetType="ContentControl">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsEditing}" Value="True">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBox Text="{Binding CaseNumber, UpdateSourceTrigger=PropertyChanged}" Height="22"/>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsEditing}" Value="False">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding CaseNumber}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ContentControl.Style>
                </ContentControl>

                <!-- Adresse -->
                <TextBlock Text="Projekt Adresse:" Grid.Row="2" Grid.Column="0" Margin="50,0,0,0" Height="16" Width="85" VerticalAlignment="Center" HorizontalAlignment="Left" />
                <ContentControl Grid.Row="2" Grid.Column="1" Content="{Binding SelectedProject}">
                    <ContentControl.Style>
                        <Style TargetType="ContentControl">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsEditing}" Value="True">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBox Text="{Binding ProjectAddress, UpdateSourceTrigger=PropertyChanged}" Height="22"/>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsEditing}" Value="False">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding ProjectAddress}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ContentControl.Style>
                </ContentControl>

                <!-- Deadline -->
                <TextBlock Text="Deadline:" Grid.Row="3" Grid.Column="0" Margin="50,0,0,0" Height="16" Width="85" VerticalAlignment="Center" HorizontalAlignment="Left" />
                <ContentControl Grid.Row="3" Grid.Column="1" Content="{Binding SelectedProject}">
                    <ContentControl.Style>
                        <Style TargetType="ContentControl">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsEditing}" Value="True">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBox Text="{Binding DeadlineInput, UpdateSourceTrigger=PropertyChanged}" 
                                                         Style="{StaticResource DateTextBoxStyle}" MaxLength="8" Height="22"/>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsEditing}" Value="False">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Deadline, StringFormat='dd/MM/yy'}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ContentControl.Style>
                </ContentControl>

                <!-- Postnummer -->
                <TextBlock Text="Postnummer:" Grid.Row="4" Grid.Column="0" Margin="63,0,0,0" Height="16" Width="72" VerticalAlignment="Center" HorizontalAlignment="Left" />
                <ContentControl Grid.Row="4" Grid.Column="1" Content="{Binding SelectedProject}">
                    <ContentControl.Style>
                        <Style TargetType="ContentControl">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsEditing}" Value="True">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBox Text="{Binding ProjectPostalCode, UpdateSourceTrigger=PropertyChanged}" Height="22"/>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsEditing}" Value="False">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding ProjectPostalCode}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ContentControl.Style>
                </ContentControl>

                <!-- Omfang -->
                <TextBlock Text="Omfang:" Grid.Row="5" Grid.Column="0" Margin="89,0,0,0" Height="16" Width="46" VerticalAlignment="Center" HorizontalAlignment="Left" />
                <ContentControl Grid.Row="5" Grid.Column="1" Content="{Binding SelectedProject}">
                    <ContentControl.Style>
                        <Style TargetType="ContentControl">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsEditing}" Value="True">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBox Text="{Binding Scope, UpdateSourceTrigger=PropertyChanged}" Height="22"/>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsEditing}" Value="False">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Scope}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ContentControl.Style>
                </ContentControl>

                <!-- Ydelser header -->
                <TextBlock Text="Ydelser" Grid.Row="6" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="5,0,0,0" Height="16"/>

                <!-- Økonomi header -->
                <TextBlock Text="Økonomi" Grid.Row="12" Grid.Column="1" HorizontalAlignment="Center" FontWeight="Bold" Width="52" />

                <!-- Tilbud afsendt -->
                <TextBlock Text="Tilbud afsendt:" Grid.Row="13" Grid.Column="0" Margin="57,0,0,0" Height="16" Width="78" VerticalAlignment="Center" HorizontalAlignment="Left" />
                <ContentControl Grid.Row="13" Grid.Column="1" Content="{Binding SelectedProject}">
                    <ContentControl.Style>
                        <Style TargetType="ContentControl">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsEditing}" Value="True">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBox Text="{Binding OfferSentInput, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DateTextBoxStyle}" MaxLength="8" Height="22"/>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsEditing}" Value="False">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding OfferSent, StringFormat='dd/MM/yy'}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ContentControl.Style>
                </ContentControl>

                <!-- Tilbud godkendt -->
                <TextBlock Text="Tilbud godkendt:" Grid.Row="14" Grid.Column="0" Margin="45,0,0,0" Height="16" Width="90" VerticalAlignment="Center" HorizontalAlignment="Left" />
                <ContentControl Grid.Row="14" Grid.Column="1" Content="{Binding SelectedProject}">
                    <ContentControl.Style>
                        <Style TargetType="ContentControl">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsEditing}" Value="True">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBox Text="{Binding OfferApprovedInput, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DateTextBoxStyle}" MaxLength="8" Height="22"/>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsEditing}" Value="False">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding OfferApproved, StringFormat='dd/MM/yy'}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ContentControl.Style>
                </ContentControl>

                <!-- Anslået pris -->
                <TextBlock Text="Anslået pris:" Grid.Row="15" Grid.Column="0" Margin="71,0,0,0" Height="16" Width="64" VerticalAlignment="Center" HorizontalAlignment="Left" />
                <ContentControl Grid.Row="15" Grid.Column="1" Content="{Binding SelectedProject}">
                    <ContentControl.Style>
                        <Style TargetType="ContentControl">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsEditing}" Value="True">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBox Text="{Binding EstimatedPrice, UpdateSourceTrigger=PropertyChanged}" Height="22"/>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsEditing}" Value="False">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding EstimatedPrice}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ContentControl.Style>
                </ContentControl>

                <!-- Pris -->
                <TextBlock Text="Pris:" Grid.Row="16" Grid.Column="0" Margin="114,0,0,0" Height="16" Width="21" VerticalAlignment="Center" HorizontalAlignment="Left" />
                <ContentControl Grid.Row="16" Grid.Column="1" Content="{Binding SelectedProject}">
                    <ContentControl.Style>
                        <Style TargetType="ContentControl">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsEditing}" Value="True">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBox Text="{Binding Price, UpdateSourceTrigger=PropertyChanged}" Height="22"/>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsEditing}" Value="False">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Price}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ContentControl.Style>
                </ContentControl>

                <!-- Betalt -->
                <TextBlock Text="Betalt:" Grid.Row="17" Grid.Column="0" Margin="102,0,0,0" Height="16" Width="33" VerticalAlignment="Center" HorizontalAlignment="Left" />
                <ContentControl Grid.Row="17" Grid.Column="1" Content="{Binding SelectedProject}">
                    <ContentControl.Style>
                        <Style TargetType="ContentControl">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsEditing}" Value="True">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBox Text="{Binding PaidInput, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DateTextBoxStyle}" MaxLength="8" Height="22"/>
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsEditing}" Value="False">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Paid, StringFormat='dd/MM/yy'}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ContentControl.Style>
                </ContentControl>
            </Grid>
        </ScrollViewer>

        <!-- Højre side med Ydelser og Kompleksitet -->
<ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" HorizontalAlignment="Left" Margin="695,0,0,0" Width="565" Height="540">
    <Grid x:Name="RightGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="30"/> <!-- Header -->
            <RowDefinition Height="Auto"/> <!-- Ydelser og Kompleksitet -->
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="480"/> <!-- Resten af pladsen -->
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/> <!-- Ydelser -->
            <ColumnDefinition Width="30"/>  <!-- Spacer -->
            <ColumnDefinition Width="75"/>  <!-- Kompleksitet -->
        </Grid.ColumnDefinitions>

        <!-- Header: Ydelser og Kompleksitet -->
        <TextBlock Text="Ydelser" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" Height="16" />
        <TextBlock Text="Kompleksitet" Grid.Row="0" Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Center" Height="16" Width="75" />

        <!-- ItemsControl for Ydelser og Kompleksitet -->
        <ItemsControl ItemsSource="{Binding SelectedProject.Services}" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3">
            <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid Margin="0,5">
                                    <!-- Definerer 1 række for hver ydelse og kompleksitet -->
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Ydelse: Kun Navn (Right Aligned) -->
                                    <ContentControl Content="{Binding}" HorizontalAlignment="Right" Grid.Column="0">
                                        <ContentControl.Style>
                                            <Style TargetType="ContentControl">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding DataContext.IsEditing, RelativeSource={RelativeSource AncestorType=Page}}" Value="True">
                                                        <Setter Property="ContentTemplate">
                                                            <Setter.Value>
                                                                <DataTemplate>
                                                                    <!-- ComboBox i redigeringstilstand med valgt ydelse -->
                                                                    <ComboBox ItemsSource="{Binding DataContext.Services, RelativeSource={RelativeSource AncestorType=Page}}"
                                                                              DisplayMemberPath="Name"
                                                                              SelectedValuePath="Id"
                                                                              SelectedValue="{Binding Id, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                                                </DataTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding DataContext.IsEditing, RelativeSource={RelativeSource AncestorType=Page}}" Value="False">
                                                        <Setter Property="ContentTemplate">
                                                            <Setter.Value>
                                                                <DataTemplate>
                                                                    <!-- TextBlock i visningstilstand -->
                                                                    <TextBlock Text="{Binding Name}" Width="200" HorizontalAlignment="Right" />
                                                                </DataTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ContentControl.Style>
                                    </ContentControl>

                                    <!-- Kompleksitet: Rediger eller vis kompleksitet (Right Aligned) -->
                                    <ContentControl Content="{Binding}" Grid.Row="0" Grid.Column="2" HorizontalAlignment="Right">
                                        <ContentControl.Style>
                                            <Style TargetType="ContentControl">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding DataContext.IsEditing, RelativeSource={RelativeSource AncestorType=Page}}" Value="True">
                                                        <Setter Property="ContentTemplate">
                                                            <Setter.Value>
                                                                <DataTemplate>
                                                                    <TextBox Text="{Binding Complexity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="50" Margin="10,0,0,0" HorizontalAlignment="Right"/>
                                                                </DataTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding DataContext.IsEditing, RelativeSource={RelativeSource AncestorType=Page}}" Value="False">
                                                        <Setter Property="ContentTemplate">
                                                            <Setter.Value>
                                                                <DataTemplate>
                                                                    <TextBlock Text="{Binding Complexity}" Width="50" Margin="10,0,0,0" HorizontalAlignment="Right"/>
                                                                </DataTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ContentControl.Style>
                                    </ContentControl>
                                </Grid>
                            </Grid>
                        </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
    </Grid>
</ScrollViewer>




        <!-- Knapper -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="25,605,0,45" Width="280">
            <Button Content="{Binding BackButtonText}" Command="{Binding CancelEditCommand}" Click="Tilbage_Click" Width="100" Margin="0,0,10,0" />
            <Button Content="{Binding EditButtonText}" Command="{Binding ToggleEditCommand}" Width="100" />
        </StackPanel>

    </Grid>
</Page>

    
    